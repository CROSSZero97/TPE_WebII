<?php require __DIR__ . '/templates/header.phtml'; ?>
<h2><?= $local ? 'Editar local' : 'Nuevo local' ?></h2>
<?php if(!empty($error)): ?>
    <p style="color:red"><?= htmlspecialchars($error) ?></p>
<?php endif; ?>
<form method="POST" action="<?= $local ? BASE_URL . 'local_update' : BASE_URL . 'local_create' ?>">
    <?php if($local): ?>
        <input type="hidden" name="id" value="<?= intval($local['id']) ?>">
    <?php endif; ?>
    <div>
        <label>Nombre
            <input name="lclnombre" type="text" required value="<?= isset($local) ? htmlspecialchars($local['lclnombre']) : '' ?>">
        </label>
    </div>
    <div>
        <label>Espera
            <input type="number" name="lclespera" min="0" value="<?= isset($local) ? intval($local['lclespera']) : 0 ?>">
        </label>
    </div>
    <div>
        <label>Especial (elegir pizza)
            <select name="lclespecial" required>
                <option value="">-- Seleccione una pizza --</option>
                <?php if(!empty($pizzas)): ?>
                    <?php foreach($pizzas as $pz): ?>
                        <?php
                            $pzId = intval($pz['id']);
                            $selected = '';
                            if(isset($local) && isset($local['lclespecial']) && intval($local['lclespecial']) === $pzId){
                                $selected = 'selected';
                            }
                        ?>
                        <option value="<?= $pzId ?>" <?= $selected ?>>
                            <?= htmlspecialchars($pz['pznombre']) ?> - $<?= number_format($pz['pzprecio'], 2) ?>
                        </option>
                    <?php endforeach; ?>
                <?php endif; ?>
            </select>
        </label>
    </div>
    <button type="submit">Guardar</button>
</form>